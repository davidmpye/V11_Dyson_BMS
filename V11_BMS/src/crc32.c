/*
 * crc32.c
 *
 * Created: 21-Jan-26 12:27:18
 *  Author: GYV1SF4
 */ 
 /*-----------------------------------------------------------------------------
    INCLUDE FILES
-----------------------------------------------------------------------------*/
#include "crc32.h"

/*-----------------------------------------------------------------------------
    DEFINITION OF GLOBAL VARIABLES
-----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
    DEFINITION OF GLOBAL CONSTANTS
-----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
    DECLARATION OF LOCAL FUNCTIONS
-----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
    DECLARATION OF LOCAL MACROS/#DEFINES
-----------------------------------------------------------------------------*/
#define CRC_INITIAL_VALUE32         (uint32_t)(0x7F77E799)
#define CRC_INITIAL_VALUE32_REFLECT (uint32_t)(0x99E7EEFE)
#define CRC_POLYNOMIAL_32           (uint32_t)(0x04C11DB7)
#define CRC_POLYNOMIAL_32_REFLECT   (uint32_t)(0xEDB88320)
#define CRC_FINAL_XOR_CRC32         (uint32_t)(0x00000000)

/*-----------------------------------------------------------------------------
    DEFINITION OF LOCAL TYPES
-----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
    DEFINITION OF LOCAL VARIABLES
-----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
    DEFINITION OF LOCAL CONSTANTS
-----------------------------------------------------------------------------*/
static const uint32_t c_wCRC32Table[16] = 
{
  0x00000000, 0x1DB71064, 0x3B6E20C8, 0x26D930AC,
  0x76DC4190, 0x6B6B51F4, 0x4DB26158, 0x5005713C,
  0xEDB88320, 0xF00F9344, 0xD6D6A3E8, 0xCB61B38C,
  0x9B64C2B0, 0x86D3D2D4, 0xA00AE278, 0xBDBDF21C,
};

/*-----------------------------------------------------------------------------
    DEFINITION OF LOCAL FUNCTIONS PROTOTYPES
-----------------------------------------------------------------------------*/

/*-----------------------------------------------------------------------------
    DEFINITION OF GLOBAL FUNCTIONS
-----------------------------------------------------------------------------*/
//- **************************************************************************
//! \brief 
//!         CRC32
//*!        Poly: 0x04C11DB7
//*!        Init: 0x7F77E799
//*!        RefIn: True
//*!        RefOut: True
//*!        XorOut: 0x00000000
//- **************************************************************************
uint32_t calc_crc32(uint8_t * data_ptr, uint16_t len)
{
  uint16_t i;
  uint32_t wCRC32 = CRC_INITIAL_VALUE32_REFLECT;

  if(NULL == data_ptr)
  {
    return 0;
  }

  for (i = 0; i < len; i++)
  {
    wCRC32 = (wCRC32 >> 4) ^ c_wCRC32Table[(wCRC32 & 0x0000000F) ^ (*data_ptr & 0x0F)];
    wCRC32 = (wCRC32 >> 4) ^ c_wCRC32Table[(wCRC32 & 0x0000000F) ^ (*data_ptr++ >> 4)];
  }

  return (wCRC32);
}
/*-----------------------------------------------------------------------------
    DEFINITION OF LOCAL FUNCTIONS
-----------------------------------------------------------------------------*/
//- **************************************************************************
//! \brief 
//- **************************************************************************
/*-----------------------------------------------------------------------------
    END OF MODULE
-----------------------------------------------------------------------------*/
